# 01-介绍

[TOC]

> ZooKeeper：分布式应用程序的分布式协调服务。动机是减轻分布式应用程序从头开始实现协调服务的责任

**特点：**

- 文件系统**目录树结构**风格
- 数据保存在**内存**
- 严格的**排序**

**功能：**

- 同步
- 协调的分布式进程
- 节点被设计用于存储协调数据

内存中维护的状态图像

![zkservice](https://tva1.sinaimg.cn/large/e6c9d24ely1h6m410fvbzj20go055aaj.jpg)

## 数据模型和分层命名空间

ZooKeeper 提供的命名空间很像标准文件系统。名称是由斜杠 (/) 分隔的一系列路径元素。ZooKeeper 命名空间中的每个节点都由路径标识。

![zknamespace](https://tva1.sinaimg.cn/large/e6c9d24ely1h6m440qg8ij20ca071q31.jpg)

## 节点和临时节点

**节点(Znode)**

1. ZooKeeper 命名空间中的每个节点都可以拥有与其关联的数据以及子节点
2. 字节到千字节的范围内，被设计用于存储协调数据：状态信息、配置、位置信息等
3. 数据更改时，版本号增加，客户端检索数据时，它也会收到数据的版本
4. 原子读取和写入
5. 每个节点都有一个访问控制列表 (ACL)，它限制谁可以做什么

**临时节点**

只要创建 znode 的会话处于活动状态，这些 znode 就存在。当会话结束时，znode 被删除

## 监视

> *ZooKeeper*支持 watch 的概念

客户端可以在 znode 上设置监视，当 znode 发生变化时，watch 将被触发并移除，当 watch 被触发时，客户端会收到一个数据包，说明 znode 已更改

**3.6.0 中的新功能：**客户端还可以在 znode 上设置永久的递归监视，这些监视在触发时不会被删除，并且会以递归方式触发已注册 znode 以及任何子 znode 上的更改。

## 保障

- **顺序一致性** - 来自客户端的更新将按照它们发送的顺序应用
- **原子性** - 没有中间态，要么成功、要么失败
- **可靠性** - 应用更新后，它将从那时起持续存在，直到客户端覆盖更新。
- **单一系统映像** - 客户端故障转移到具有相同会话的不同服务器，客户端也永远不会看到系统的旧视图

## 简单的 API

> ZooKeeper 的设计目标之一是提供一个非常简单的编程接口

仅支持以下操作：

- *create*：在树中的某个位置创建一个节点
- *delete* : 删除一个节点
- *exists*：测试节点是否存在于某个位置
- *get data* : 从一个节点读数据
- *set data* : 向一个节点写数据
- *get children* : 检索节点的子节点列表
- *sync* : 等待数据传播

